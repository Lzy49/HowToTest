# 单元测试
## 对应课时
- [06-单元级别的功能测试] (https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_63ff7257e4b02685a44bc7e8?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
## 一个单元是指一个功能 , 非 一个 class , 一个 function
1. 在测试的过程中, 我们只需要关系功能模块的出口接口即可,不需要关心内部的函数实现. 因为在测试接口的时候,就会在内部完成这些内部函数的测试.
2. 内部函数的暴露,和单独测试会增加后续的维护成本,破坏模块密闭性 且 是毫无意义的.
3. 功能可大可小,可以是一个函数,也可以是多个函数.
# 写单测的好处
## 自己观点 (想)
- 以测试驱动代码.
- 单测减少代码错误,减少错误定位难度.
- 因为要写单测,所以会在写代码时进行更细致的拆分.
## 课中观点 (学)
- 提高开发效率
  - 更高阶的调试手法
  - 验证局部逻辑 一步到位
- 对修改代码更加自信
  - 新增功能 & 修 bug
  - 重构代码
  - check 别人提交的代码
- 活文档
- 改善程序设计 
## 提高效率 & 修改代码更自信
### 对应课时 
- [课程 01-为什么写测试-更高阶的调试手法-提高开发效率](https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_63f37a52e4b030cacb189f3a?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=%2a%2a6%2a%2a)
- [02-单元测试在修改代码时的好处](https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_63f6e324e4b02685a448152d?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
- [03-写测试的好处-活文档&改善程序设计](https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_63f9c24ce4b06159f741212d?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
- [04-自动化思维-功能验证](https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_63fb6f8ce4b030cacb1bd03f?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
- [05-自动化思维-定位&修复bug](https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_63fccaafe4b02685a44a853c?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
### 写新功能 场景
- 无单测写代码: 实现代码 -> 调试 (手动) -有错误-> 更改 -> ..
- 有单测写代码: 实现测试 -> 实现代码 -> 执行测试 -> 更改 -> 执行测试 
> 虽代码增加,但好处增加
> 1. 写单测会带来额外时间, 但是 可以自动化测试节省后续调试时间. 
> 2. 单测会成为代码对应的工能文档, 便于后续代码修改,逻辑梳理
### 修改代码 场景
- 无单测 : 修改老代码 -> 测试修改点流程 -> 测试记得的旧逻辑流程 -> 祈祷不要改坏旧代码 -> 担心 
- 有单测 : 建立修改点单测 -> 修改老代码 -> 跑新单测 -> 跑老单测 -> 产出真正的影响点告之测试同学 -> 专业 + 自信
### 重构代码 场景
- 无单测 : 旧逻辑责任未知 -> 不重构 -> 旧逻辑 越来越难处理 , 且 越来越分散. -> 代码质量差 -> 修代码场景增加成本 .
- 有单测 : 旧逻辑责任已知 -> 重构 -> 代码质量提升 -> 效率增加
### check 别人代码 场景
- 无单测 : 肉眼查看代码是否有问题 -> 测试所有功能 并-> 合并 -> 希望不要有bug
- 有单测 : 自动化跑单测 ->  肉眼查看代码质量 -> 合并 -> DONE

### 调试代码场景
1. 无单测 : 发现报错 -> 从UI的第一个节点开始走流程 -> 调试到自己需要的代码 -> 修改 -> 重复流程
2. 有单测 : 发现错误 -> 执行测试整体的单元测试 -> 确定自己的错误 -> 使用单元测试 孤立调试该代码 -> 结束 
> 两种调试过程对比: <br/>
> 1. 有单测的情况下我们可以孤立测试一个功能
> 2. 有单测的情况下我们可以把一些必须要做的流程功能固化,每次调试只需要走对应流程即可.
## 除测试以外的好处
1. 单测在完成的同时, 产生活文档. 且该文档会实时的根据代码逻辑进行修改. 不会存在文档没有更新的情况 . 
2. 因为需要写单测, 如果代码耦合在一起会增加单测成本. 所以会在执行层面 驱动自己执行 单一职责原则 .
3. 代码稳定, 文档全面, 打代码开心 , 加班减少 , B格拉满 .
# 不写单测的原因
## 对应课时
- [10-不写测试的原因] (https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_640897f4e4b06159f7475222?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
## 认知误区
1. 没有写单测的时间 -> 认知误区.
2. 功能测试是测试的工作 -> 其实单测是我们的助手 , 且是白盒测试 无法替代测试同学的工作.
## 执行问题
1. 没有维护单测导致单测与逻辑不匹 -> 失去信心 -> 学习正确的单测知识
2. 同事不配合 -> 无法独立完成整个项目的单测 -> 不要在多人维护项目写单测
# 写测试顺序
### 对应课时 
- [07-写测试的顺序-后补测试](https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_6402d569e4b0fc5d123b84eb?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
- [08-写测试的顺序-通过单元测试替换手动验证](https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_640494ade4b06159f74574d2?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
- [09-写测试的顺序-先写测试后实现 TDD](https://learn.cuixueshe.com/p/t_pc/course_pc_detail/video/v_6404961ce4b02685a44db83a?product_id=p_63f3795ee4b06159f73e6452&content_app_id=&type=6)
## 补测试 ( 错误用法 )
写逻辑代码  -> 手动调试 -> 补充自动化测试代码 -> 自动化测试代码成为负担 -> 痛苦
## 后加测试 ( 正确用法 )
写逻辑代码 -> 写自动化测试代码 -> 利用自动化代码测试 -> 自动化测试代码成为 调试助手 -> 快乐
## 以测试驱动(TDD)
写测试代码 -> 以测试代码驱动逻辑代码 -> 业务梳理助手 + 验收测试助手 -> 快乐 1 + 1
### 如何以测试驱动 
1. 测试代码篇
   1. 写测试代码, 结果 + 提供 完成期望的逻辑代码调用.
   2. 运行测试代码报错
   3. 以错误驱动写逻辑代码 
2. 逻辑代码篇
   1. 根据测试代码报错 一点点的解决错误.
      1. 根据测试代码推导逻辑代码引用,命名,传值,返回值. (伪实现) 
      2. 实现代码完成逻辑
      3. 重构代码 
3. 测试篇
   1. 测? 测个P
# 其他技巧
1. 阅读源码从单测开始 (通过单测这份文档来熟悉代码逻辑) . 
